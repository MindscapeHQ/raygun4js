/*! Raygun4js - v1.8.2 - 2014-05-01
* https://github.com/MindscapeHQ/raygun4js
* Copyright (c) 2014 MindscapeHQ; Licensed MIT */
(function(n){function e(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function t(n){return n===undefined}var r={},a=n.TraceKit,i=[].slice,o="?";r.noConflict=function(){return n.TraceKit=a,r},r.wrap=function(n){function e(){try{return n.apply(this,arguments)}catch(e){throw r.report(e),e}}return e},r.report=function(){function t(n){c.push(n)}function a(n){for(var e=c.length-1;e>=0;--e)c[e]===n&&c.splice(e,1)}function o(n,t){var a=null;if(!t||r.collectWindowErrors){for(var o in c)if(e(c,o))try{c[o].apply(null,[n].concat(i.call(arguments,2)))}catch(u){a=u}if(a)throw a}}function u(e){var t=i.call(arguments,1);if(s){if(l===e)return;var a=s;s=null,l=null,o.apply(null,[a,null].concat(t))}var u=r.computeStackTrace(e);throw s=u,l=e,n.setTimeout(function(){l===e&&(s=null,l=null,o.apply(null,[u,null].concat(t)))},u.incomplete?2e3:0),e}var c=[],l=null,s=null,f=n.onerror;return n.onerror=function(n,e,t,a,i){var u=null;if(i)u=r.computeStackTrace(i);else if(s)r.computeStackTrace.augmentStackTraceWithInitialElement(s,e,t,n),u=s,s=null,l=null;else{var c={url:e,line:t,column:a};c.func=r.computeStackTrace.guessFunctionName(c.url,c.line),c.context=r.computeStackTrace.gatherContext(c.url,c.line),u={mode:"onerror",message:n,url:document.location.href,stack:[c],useragent:navigator.userAgent}}return o(u,"from window.onerror"),f?f.apply(this,arguments):!1},u.subscribe=t,u.unsubscribe=a,u}(),r.computeStackTrace=function(){function a(e){function t(){try{return new n.XMLHttpRequest}catch(e){return new n.ActiveXObject("Microsoft.XMLHTTP")}}if(!r.remoteFetching)return"";try{var a=t();return a.open("GET",e,!1),a.send(""),a.responseText}catch(i){return""}}function i(n){if(!e(k,n)){var t="";n=n||"",-1!==n.indexOf(document.domain)&&(t=a(n)),k[n]=t?t.split("\n"):[]}return k[n]}function u(n,e){var r,a=/function ([^(]*)\(([^)]*)\)/,u=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,c="",l=10,s=i(n);if(!s.length)return o;for(var f=0;l>f;++f)if(c=s[e-f]+c,!t(c)){if(r=u.exec(c))return r[1];if(r=a.exec(c))return r[1]}return o}function c(n,e){var a=i(n);if(!a.length)return null;var o=[],u=Math.floor(r.linesOfContext/2),c=u+r.linesOfContext%2,l=Math.max(0,e-u-1),s=Math.min(a.length,e+c-1);e-=1;for(var f=l;s>f;++f)t(a[f])||o.push(a[f]);return o.length>0?o:null}function l(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function s(n){return l(n).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function f(n,e){for(var t,r,a=0,o=e.length;o>a;++a)if((t=i(e[a])).length&&(t=t.join("\n"),r=n.exec(t)))return{url:e[a],line:t.substring(0,r.index).split("\n").length,column:r.index-t.lastIndexOf("\n",r.index)-1};return null}function g(n,e,t){var r,a=i(e),o=RegExp("\\b"+l(n)+"\\b");return t-=1,a&&a.length>t&&(r=o.exec(a[t]))?r.index:null}function h(e){for(var t,r,a,i,o=[n.location.href],u=document.getElementsByTagName("script"),c=""+e,g=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,h=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=0;u.length>p;++p){var m=u[p];m.src&&o.push(m.src)}if(a=g.exec(c)){var d=a[1]?"\\s+"+a[1]:"",v=a[2].split(",").join("\\s*,\\s*");t=l(a[3]).replace(/;$/,";?"),r=RegExp("function"+d+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+t+"\\s*}")}else r=RegExp(l(c).replace(/\s+/g,"\\s+"));if(i=f(r,o))return i;if(a=h.exec(c)){var y=a[1];if(t=s(a[2]),r=RegExp("on"+y+"=[\\'\"]\\s*"+t+"\\s*[\\'\"]","i"),i=f(r,o[0]))return i;if(r=RegExp(t),i=f(r,o))return i}return null}function p(n){if(!n.stack)return null;for(var e,t,r=/^\s*at (?:((?:\[object object\])?\S+) )?\(?((?:file|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,a=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http|https).*?):(\d+)(?::(\d+))?\s*$/i,i=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:ms-appx|http|https):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=n.stack.split("\n"),s=[],f=/^(.*) is undefined$/.exec(n.message),h=0,p=l.length;p>h;++h){if(e=a.exec(l[h]))t={url:e[3],func:e[1]||o,args:e[2]?e[2].split(","):"",line:+e[4],column:e[5]?+e[5]:null};else if(e=r.exec(l[h]))t={url:e[2],func:e[1]||o,line:+e[3],column:e[4]?+e[4]:null};else{if(!(e=i.exec(l[h])))continue;t={url:e[2],func:e[1]||o,line:+e[3],column:e[4]?+e[4]:null}}!t.func&&t.line&&(t.func=u(t.url,t.line)),t.line&&(t.context=c(t.url,t.line)),s.push(t)}return s[0]&&s[0].line&&!s[0].column&&f&&(s[0].column=g(f[1],s[0].url,s[0].line)),s.length?{mode:"stack",name:n.name,message:n.message,url:document.location.href,stack:s,useragent:navigator.userAgent}:null}function m(n){for(var e,t=n.stacktrace,r=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,a=t.split("\n"),i=[],o=0,l=a.length;l>o;o+=2)if(e=r.exec(a[o])){var s={line:+e[1],column:+e[2],func:e[3]||e[4],args:e[5]?e[5].split(","):[],url:e[6]};if(!s.func&&s.line&&(s.func=u(s.url,s.line)),s.line)try{s.context=c(s.url,s.line)}catch(f){}s.context||(s.context=[a[o+1]]),i.push(s)}return i.length?{mode:"stacktrace",name:n.name,message:n.message,url:document.location.href,stack:i,useragent:navigator.userAgent}:null}function d(t){var r=t.message.split("\n");if(4>r.length)return null;var a,o,l,g,h=/^\s*Line (\d+) of linked script ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,p=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http|https)\S+)(?:: in function (\S+))?\s*$/i,m=/^\s*Line (\d+) of function script\s*$/i,d=[],v=document.getElementsByTagName("script"),y=[];for(o in v)e(v,o)&&!v[o].src&&y.push(v[o]);for(o=2,l=r.length;l>o;o+=2){var w=null;if(a=h.exec(r[o]))w={url:a[2],func:a[3],line:+a[1]};else if(a=p.exec(r[o])){w={url:a[3],func:a[4]};var x=+a[1],S=y[a[2]-1];if(S&&(g=i(w.url))){g=g.join("\n");var k=g.indexOf(S.innerText);k>=0&&(w.line=x+g.substring(0,k).split("\n").length)}}else if(a=m.exec(r[o])){var T=n.location.href.replace(/#.*$/,""),b=a[1],R=RegExp(s(r[o+1]));g=f(R,[T]),w={url:T,line:g?g.line:b,func:""}}if(w){w.func||(w.func=u(w.url,w.line));var j=c(w.url,w.line),C=j?j[Math.floor(j.length/2)]:null;w.context=j&&C.replace(/^\s*/,"")===r[o+1].replace(/^\s*/,"")?j:[r[o+1]],d.push(w)}}return d.length?{mode:"multiline",name:t.name,message:r[0],url:document.location.href,stack:d,useragent:navigator.userAgent}:null}function v(n,e,t,r){var a={url:e,line:t};if(a.url&&a.line){n.incomplete=!1,a.func||(a.func=u(a.url,a.line)),a.context||(a.context=c(a.url,a.line));var i=/ '([^']+)' /.exec(r);if(i&&(a.column=g(i[1],a.url,a.line)),n.stack.length>0&&n.stack[0].url===a.url){if(n.stack[0].line===a.line)return!1;if(!n.stack[0].line&&n.stack[0].func===a.func)return n.stack[0].line=a.line,n.stack[0].context=a.context,!1}return n.stack.unshift(a),n.partial=!0,!0}return n.incomplete=!0,!1}function y(n,e){for(var t,a,i,c=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,l=[],s={},f=!1,p=y.caller;p&&!f;p=p.caller)if(p!==w&&p!==r.report){if(a={url:null,func:o,line:null,column:null},p.name?a.func=p.name:(t=c.exec(""+p))&&(a.func=t[1]),i=h(p)){a.url=i.url,a.line=i.line,a.func===o&&(a.func=u(a.url,a.line));var m=/ '([^']+)' /.exec(n.message||n.description);m&&(a.column=g(m[1],i.url,i.line))}s[""+p]?f=!0:s[""+p]=!0,l.push(a)}e&&l.splice(0,e);var d={mode:"callers",name:n.name,message:n.message,url:document.location.href,stack:l,useragent:navigator.userAgent};return v(d,n.sourceURL||n.fileName,n.line||n.lineNumber,n.message||n.description),d}function w(n,e){var t=null;e=null==e?0:+e;try{if(t=m(n))return t}catch(r){if(S)throw r}try{if(t=p(n))return t}catch(r){if(S)throw r}try{if(t=d(n))return t}catch(r){if(S)throw r}try{if(t=y(n,e+1))return t}catch(r){if(S)throw r}return{mode:"failed"}}function x(n){n=(null==n?0:+n)+1;try{throw Error()}catch(e){return w(e,n+1)}return null}var S=!1,k={};return w.augmentStackTraceWithInitialElement=v,w.guessFunctionName=u,w.gatherContext=c,w.ofCaller=x,w}(),function(){var e=function e(e){var t=n[e];n[e]=function(){var n=i.call(arguments),e=n[0];return"function"==typeof e&&(n[0]=r.wrap(e)),t.apply?t.apply(this,n):t(n[0],n[1])}};e("setTimeout"),e("setInterval")}(),function(n){if(n){var e=n.event.add;n.event.add=function(t,a,i,o,u){var c;return i.handler?(c=i.handler,i.handler=r.wrap(i.handler)):(c=i,i=r.wrap(i)),i.guid=c.guid?c.guid:c.guid=n.guid++,e.call(this,t,a,i,o,u)};var t=n.fn.ready;n.fn.ready=function(n){return t.call(this,r.wrap(n))};var a=n.ajax;n.ajax=function(e){for(var t,i=["complete","error","success"];t=i.pop();)n.isFunction(e[t])&&(e[t]=r.wrap(e[t]));try{return a.call(this,e)}catch(o){throw r.report(o),o}}}}(n.jQuery),r.remoteFetching||(r.remoteFetching=!0),r.collectWindowErrors||(r.collectWindowErrors=!0),(!r.linesOfContext||1>r.linesOfContext)&&(r.linesOfContext=11),n.TraceKit=r})(window),function(n,e){"use strict";if(n){var t=n.event.add;n.event.add=function(r,a,i,o,u){var c;return i.handler?(c=i.handler,i.handler=e.wrap(i.handler)):(c=i,i=e.wrap(i)),i.guid=c.guid?c.guid:c.guid=n.guid++,t.call(this,r,a,i,o,u)};var r=n.fn.ready;n.fn.ready=function(n){return r.call(this,e.wrap(n))};var a=n.ajax;n.ajax=function(t,r){"object"==typeof t&&(r=t,t=void 0),r=r||{};for(var i,o=["complete","error","success"];i=o.pop();)n.isFunction(r[i])&&(r[i]=e.wrap(r[i]));try{return t?a.call(this,t,r):a.call(this,r)}catch(u){throw e.report(u),u}}}}(window.jQuery,window.TraceKit),function(n,e,t){function r(n){var e=n.split("//")[1],t=e.indexOf("?"),r=(""+e).substring(0,t),a=r.split("/").slice(0,4).join("/"),i=r.substring(0,48),o=a.length<i.length?a:i;return o!==r&&(o+=".."),o}function a(n,e,a,i){var o="AJAX Error: "+(e.statusText||"unknown")+" "+(a.type||"unknown")+" "+(r(a.url)||"unknown");D.send(i||n.type,{status:e.status,statusText:e.statusText,type:a.type,url:a.url,ajaxErrorMessage:o,contentType:a.contentType,data:a.data?a.data.slice(0,10240):t})}function i(e,t){n.console&&n.console.log&&R&&(n.console.log(e),t&&n.console.log(t))}function o(){return w&&""!==w?!0:(i("Raygun API key has not been configured, make sure you call Raygun.init(yourApiKey)"),!1)}function u(n,e){var t,r={};for(t in n)r[t]=n[t];for(t in e)r[t]=e[t];return r}function c(n,e){return null!=e?n.concat(e):n}function l(n,e){for(var t=0;n.length>t;t++)e.call(null,t,n[t])}function s(n){for(var e in n)if(n.hasOwnProperty(e))return!1;return!0}function f(){return Math.floor(9007199254740992*Math.random())}function g(){var e=document.documentElement,t=document.getElementsByTagName("body")[0],r=n.innerWidth||e.clientWidth||t.clientWidth,a=n.innerHeight||e.clientHeight||t.clientHeight;return{width:r,height:a}}function h(n){var e=(new Date).toJSON();try{var r="raygunjs="+e+"="+f();localStorage[r]===t&&(localStorage[r]=n)}catch(a){i("Raygun4JS: LocalStorage full, cannot save exception")}}function p(){for(var n in localStorage)"raygunjs="===n.substring(0,9)&&(d(JSON.parse(localStorage[n])),localStorage.removeItem(n))}function m(e,r){var a=[],i={};e.stack&&e.stack.length&&l(e.stack,function(n,e){a.push({LineNumber:e.line,ColumnNumber:e.column,ClassName:"line "+e.line+", column "+e.column,FileName:e.url,MethodName:e.func||"[anonymous]"})}),n.location.search&&n.location.search.length>1&&l(n.location.search.substring(1).split("&"),function(n,e){var t=e.split("=");t&&2===t.length&&(i[decodeURIComponent(t[0])]=t[1])}),r===t&&(r={}),s(r.customData)&&(r.customData=E),s(r.tags)&&(r.tags=O);var o=n.screen||{width:g().width,height:g().height,colorDepth:8},u=r.customData&&r.customData.ajaxErrorMessage,c={OccurredOn:new Date,Details:{Error:{ClassName:e.name,Message:u||e.message||r.status||"Script error",StackTrace:a},Environment:{UtcOffset:(new Date).getTimezoneOffset()/-60,"User-Language":navigator.userLanguage,"Document-Mode":document.documentMode,"Browser-Width":g().width,"Browser-Height":g().height,"Screen-Width":o.width,"Screen-Height":o.height,"Color-Depth":o.colorDepth,Browser:navigator.appCodeName,"Browser-Name":navigator.appName,"Browser-Version":navigator.appVersion,Platform:navigator.platform},Client:{Name:"raygun-js",Version:"1.8.1"},UserCustomData:r.customData,Tags:r.tags,Request:{Url:document.location.href,QueryString:i,Headers:{"User-Agent":navigator.userAgent,Referer:document.referrer,Host:document.domain}},Version:S||"Not supplied"}};x&&(c.Details.User=x),d(c)}function d(n){if(o()){i("Sending exception data to Raygun:",n);var e=N+"/entries?apikey="+encodeURIComponent(w);y(e,JSON.stringify(n))}}function v(e,t){var r;return r=new n.XMLHttpRequest,"withCredentials"in r?r.open(e,t,!0):n.XDomainRequest&&(j&&(t=t.slice(6)),r=new n.XDomainRequest,r.open(e,t)),r.timeout=1e4,r}function y(e,r){var a=v("POST",e,r);return"withCredentials"in a?(a.onreadystatechange=function(){4===a.readyState&&(202===a.status?p():C&&403!==a.status&&400!==a.status&&h(r))},a.onload=function(){i("logged error to Raygun")}):n.XDomainRequest&&(a.ontimeout=function(){C&&(i("Raygun: saved error locally"),h(r))},a.onload=function(){i("logged error to Raygun"),p()}),a.onerror=function(){i("failed to log error to Raygun")},a?(a.send(r),t):(i("CORS not supported"),t)}var w,x,S,k,T=TraceKit.noConflict(),b=n.Raygun,R=!1,j=!1,C=!1,E={},O=[],N="https://api.raygun.io";e&&(k=e(document));var D={noConflict:function(){return n.Raygun=b,D},init:function(n,e,t){return w=n,T.remoteFetching=!1,E=t,e&&(j=e.allowInsecureSubmissions||!1,e.debugMode&&(R=e.debugMode)),p(),D},withCustomData:function(n){return E=n,D},withTags:function(n){O=n},attach:function(){return o()?(T.report.subscribe(m),k&&k.ajaxError(a),D):t},detach:function(){return T.report.unsubscribe(m),k&&k.unbind("ajaxError",a),D},send:function(n,e,t){try{m(T.computeStackTrace(n),{customData:u(E,e),tags:c(O,t)})}catch(r){if(n!==r)throw r}return D},setUser:function(n){return x={Identifier:n},D},setVersion:function(n){return S=n,D},saveIfOffline:function(n){return n!==t&&"boolean"==typeof n&&(C=n),D}};n.Raygun=D}(window,window.jQuery);